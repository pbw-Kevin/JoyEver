import{U as mt,$ as z,V as ht,W as U,X,Y as ft,Z as gt,a0 as ut,a1 as J,a2 as dt,a3 as Z,a4 as vt,a5 as pt,a6 as xt,a7 as It,a8 as yt,a9 as kt,aa as Ct,ab as bt,ac as wt,ad as At,ae as Et,af as Rt,ag as Ot,d as Tt,y as Bt,K as Gt,ah as Y,C as N,N as Mt,S as Nt,ai as F,aj as st,p as Lt,ak as St,c as R,a as y,al as $,e as D,u as x,am as P,an as _,b as W,F as qt,q as Vt,t as tt,ao as K,ap as Dt,o as O,aq as nt,ar as zt,as as Ft,_ as Ut}from"./index-BU4OnsB9.js";const jt={onClick:U},at="mdui.functions.dialog.";let Q;const ct=v=>{const t=new mt,e=z(t),s=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions"],a=["onOpen","onOpened","onClose","onClosed","onOverlayClick"];return Object.entries(v).forEach(([i,o])=>{if(s.includes(i))t[i]=o;else if(a.includes(i)){const r=ht(i.slice(2));e.on(r,m=>{m.target===t&&o.call(t,t)})}}),v.body&&e.append(v.body),v.actions&&v.actions.forEach(i=>{const o=Object.assign({},jt,i);z(`<mdui-button
        slot="action"
        variant="text"
      >${o.text}</mdui-button>`).appendTo(e).on("click",function(){const r=o.onClick.call(t,t);X(r)?(this.loading=!0,r.then(()=>{t.open=!1}).finally(()=>{this.loading=!1})):r!==!1&&(t.open=!1)})}),e.appendTo("body").on("closed",i=>{i.target===t&&(e.remove(),v.queue&&(Q=void 0,ft(at+v.queue)))}),v.queue?Q?gt(at+v.queue,()=>{t.open=!0,Q=t}):(setTimeout(()=>{t.open=!0}),Q=t):setTimeout(()=>{t.open=!0}),t},it=()=>Z("OK"),rt=()=>Z("Cancel"),$t=v=>{const t=Object.assign({},{confirmText:it(),cancelText:rt(),onConfirm:U,onCancel:U},v),e=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions","queue","onOpen","onOpened","onClose","onClosed","onOverlayClick"];return new Promise((s,a)=>{let i=!1;const o=ct({...Object.fromEntries(e.filter(r=>!ut(t[r])).map(r=>[r,t[r]])),actions:[{text:t.cancelText,onClick:r=>t.onCancel.call(r,r)},{text:t.confirmText,onClick:r=>{const m=t.onConfirm.call(r,r);return X(m)?m.then(()=>{i=!0}):m!==!1&&(i=!0),m}}]});v.confirmText||J(o,()=>{z(o).find('[slot="action"]').last().text(it())}),v.cancelText||J(o,()=>{z(o).find('[slot="action"]').first().text(rt())}),z(o).on("close",r=>{r.target===o&&(i?s():a(),dt(o))})})};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{fromInt(t){return vt(t)}toInt(t){return pt(t[0],t[1],t[2])}distance(t,e){const s=t[0]-e[0],a=t[1]-e[1],i=t[2]-e[2];return s*s+a*a+i*i}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _t=10,Wt=3;class Kt{static quantize(t,e,s){const a=new Map,i=new Array,o=new Array,r=new Pt;let m=0;for(let d=0;d<t.length;d++){const k=t[d],E=a.get(k);E===void 0?(m++,i.push(r.fromInt(k)),o.push(k),a.set(k,1)):a.set(k,E+1)}const b=new Array;for(let d=0;d<m;d++){const k=o[d],E=a.get(k);E!==void 0&&(b[d]=E)}let h=Math.min(s,m);e.length>0&&(h=Math.min(h,e.length));const I=new Array;for(let d=0;d<e.length;d++)I.push(r.fromInt(e[d]));const A=h-I.length;if(e.length===0&&A>0)for(let d=0;d<A;d++){const k=Math.random()*100,E=Math.random()*201+-100,S=Math.random()*201+-100;I.push(new Array(k,E,S))}const f=new Array;for(let d=0;d<m;d++)f.push(Math.floor(Math.random()*h));const u=new Array;for(let d=0;d<h;d++){u.push(new Array);for(let k=0;k<h;k++)u[d].push(0)}const g=new Array;for(let d=0;d<h;d++){g.push(new Array);for(let k=0;k<h;k++)g[d].push(new Qt)}const w=new Array;for(let d=0;d<h;d++)w.push(0);for(let d=0;d<_t;d++){for(let p=0;p<h;p++){for(let C=p+1;C<h;C++){const M=r.distance(I[p],I[C]);g[C][p].distance=M,g[C][p].index=p,g[p][C].distance=M,g[p][C].index=C}g[p].sort();for(let C=0;C<h;C++)u[p][C]=g[p][C].index}let k=0;for(let p=0;p<m;p++){const C=i[p],M=f[p],q=I[M],V=r.distance(C,q);let c=V,n=-1;for(let l=0;l<h;l++){if(g[M][l].distance>=4*V)continue;const et=r.distance(C,I[l]);et<c&&(c=et,n=l)}n!==-1&&Math.abs(Math.sqrt(c)-Math.sqrt(V))>Wt&&(k++,f[p]=n)}if(k===0&&d!==0)break;const E=new Array(h).fill(0),S=new Array(h).fill(0),G=new Array(h).fill(0);for(let p=0;p<h;p++)w[p]=0;for(let p=0;p<m;p++){const C=f[p],M=i[p],q=b[p];w[C]+=q,E[C]+=M[0]*q,S[C]+=M[1]*q,G[C]+=M[2]*q}for(let p=0;p<h;p++){const C=w[p];if(C===0){I[p]=[0,0,0];continue}const M=E[p]/C,q=S[p]/C,V=G[p]/C;I[p]=[M,q,V]}}const T=new Map;for(let d=0;d<h;d++){const k=w[d];if(k===0)continue;const E=r.toInt(I[d]);T.has(E)||T.set(E,k)}return T}}class Qt{constructor(){this.distance=-1,this.index=-1}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{static quantize(t){const e=new Map;for(let s=0;s<t.length;s++){const a=t[s];xt(a)<255||e.set(a,(e.get(a)??0)+1)}return e}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H=5,L=33,j=35937,B={RED:"red",GREEN:"green",BLUE:"blue"};class Xt{constructor(t=[],e=[],s=[],a=[],i=[],o=[]){this.weights=t,this.momentsR=e,this.momentsG=s,this.momentsB=a,this.moments=i,this.cubes=o}quantize(t,e){this.constructHistogram(t),this.computeMoments();const s=this.createBoxes(e);return this.createResult(s.resultCount)}constructHistogram(t){this.weights=Array.from({length:j}).fill(0),this.momentsR=Array.from({length:j}).fill(0),this.momentsG=Array.from({length:j}).fill(0),this.momentsB=Array.from({length:j}).fill(0),this.moments=Array.from({length:j}).fill(0);const e=Ht.quantize(t);for(const[s,a]of e.entries()){const i=It(s),o=yt(s),r=kt(s),m=8-H,b=(i>>m)+1,h=(o>>m)+1,I=(r>>m)+1,A=this.getIndex(b,h,I);this.weights[A]=(this.weights[A]??0)+a,this.momentsR[A]+=a*i,this.momentsG[A]+=a*o,this.momentsB[A]+=a*r,this.moments[A]+=a*(i*i+o*o+r*r)}}computeMoments(){for(let t=1;t<L;t++){const e=Array.from({length:L}).fill(0),s=Array.from({length:L}).fill(0),a=Array.from({length:L}).fill(0),i=Array.from({length:L}).fill(0),o=Array.from({length:L}).fill(0);for(let r=1;r<L;r++){let m=0,b=0,h=0,I=0,A=0;for(let f=1;f<L;f++){const u=this.getIndex(t,r,f);m+=this.weights[u],b+=this.momentsR[u],h+=this.momentsG[u],I+=this.momentsB[u],A+=this.moments[u],e[f]+=m,s[f]+=b,a[f]+=h,i[f]+=I,o[f]+=A;const g=this.getIndex(t-1,r,f);this.weights[u]=this.weights[g]+e[f],this.momentsR[u]=this.momentsR[g]+s[f],this.momentsG[u]=this.momentsG[g]+a[f],this.momentsB[u]=this.momentsB[g]+i[f],this.moments[u]=this.moments[g]+o[f]}}}}createBoxes(t){this.cubes=Array.from({length:t}).fill(0).map(()=>new Jt);const e=Array.from({length:t}).fill(0);this.cubes[0].r0=0,this.cubes[0].g0=0,this.cubes[0].b0=0,this.cubes[0].r1=L-1,this.cubes[0].g1=L-1,this.cubes[0].b1=L-1;let s=t,a=0;for(let i=1;i<t;i++){this.cut(this.cubes[a],this.cubes[i])?(e[a]=this.cubes[a].vol>1?this.variance(this.cubes[a]):0,e[i]=this.cubes[i].vol>1?this.variance(this.cubes[i]):0):(e[a]=0,i--),a=0;let o=e[0];for(let r=1;r<=i;r++)e[r]>o&&(o=e[r],a=r);if(o<=0){s=i+1;break}}return new Zt(t,s)}createResult(t){const e=[];for(let s=0;s<t;++s){const a=this.cubes[s],i=this.volume(a,this.weights);if(i>0){const o=Math.round(this.volume(a,this.momentsR)/i),r=Math.round(this.volume(a,this.momentsG)/i),m=Math.round(this.volume(a,this.momentsB)/i),b=255<<24|(o&255)<<16|(r&255)<<8|m&255;e.push(b)}}return e}variance(t){const e=this.volume(t,this.momentsR),s=this.volume(t,this.momentsG),a=this.volume(t,this.momentsB),i=this.moments[this.getIndex(t.r1,t.g1,t.b1)]-this.moments[this.getIndex(t.r1,t.g1,t.b0)]-this.moments[this.getIndex(t.r1,t.g0,t.b1)]+this.moments[this.getIndex(t.r1,t.g0,t.b0)]-this.moments[this.getIndex(t.r0,t.g1,t.b1)]+this.moments[this.getIndex(t.r0,t.g1,t.b0)]+this.moments[this.getIndex(t.r0,t.g0,t.b1)]-this.moments[this.getIndex(t.r0,t.g0,t.b0)],o=e*e+s*s+a*a,r=this.volume(t,this.weights);return i-o/r}cut(t,e){const s=this.volume(t,this.momentsR),a=this.volume(t,this.momentsG),i=this.volume(t,this.momentsB),o=this.volume(t,this.weights),r=this.maximize(t,B.RED,t.r0+1,t.r1,s,a,i,o),m=this.maximize(t,B.GREEN,t.g0+1,t.g1,s,a,i,o),b=this.maximize(t,B.BLUE,t.b0+1,t.b1,s,a,i,o);let h;const I=r.maximum,A=m.maximum,f=b.maximum;if(I>=A&&I>=f){if(r.cutLocation<0)return!1;h=B.RED}else A>=I&&A>=f?h=B.GREEN:h=B.BLUE;switch(e.r1=t.r1,e.g1=t.g1,e.b1=t.b1,h){case B.RED:t.r1=r.cutLocation,e.r0=t.r1,e.g0=t.g0,e.b0=t.b0;break;case B.GREEN:t.g1=m.cutLocation,e.r0=t.r0,e.g0=t.g1,e.b0=t.b0;break;case B.BLUE:t.b1=b.cutLocation,e.r0=t.r0,e.g0=t.g0,e.b0=t.b1;break;default:throw new Error("unexpected direction "+h)}return t.vol=(t.r1-t.r0)*(t.g1-t.g0)*(t.b1-t.b0),e.vol=(e.r1-e.r0)*(e.g1-e.g0)*(e.b1-e.b0),!0}maximize(t,e,s,a,i,o,r,m){const b=this.bottom(t,e,this.momentsR),h=this.bottom(t,e,this.momentsG),I=this.bottom(t,e,this.momentsB),A=this.bottom(t,e,this.weights);let f=0,u=-1,g=0,w=0,T=0,d=0;for(let k=s;k<a;k++){if(g=b+this.top(t,e,k,this.momentsR),w=h+this.top(t,e,k,this.momentsG),T=I+this.top(t,e,k,this.momentsB),d=A+this.top(t,e,k,this.weights),d===0)continue;let E=(g*g+w*w+T*T)*1,S=d*1,G=E/S;g=i-g,w=o-w,T=r-T,d=m-d,d!==0&&(E=(g*g+w*w+T*T)*1,S=d*1,G+=E/S,G>f&&(f=G,u=k))}return new Yt(u,f)}volume(t,e){return e[this.getIndex(t.r1,t.g1,t.b1)]-e[this.getIndex(t.r1,t.g1,t.b0)]-e[this.getIndex(t.r1,t.g0,t.b1)]+e[this.getIndex(t.r1,t.g0,t.b0)]-e[this.getIndex(t.r0,t.g1,t.b1)]+e[this.getIndex(t.r0,t.g1,t.b0)]+e[this.getIndex(t.r0,t.g0,t.b1)]-e[this.getIndex(t.r0,t.g0,t.b0)]}bottom(t,e,s){switch(e){case B.RED:return-s[this.getIndex(t.r0,t.g1,t.b1)]+s[this.getIndex(t.r0,t.g1,t.b0)]+s[this.getIndex(t.r0,t.g0,t.b1)]-s[this.getIndex(t.r0,t.g0,t.b0)];case B.GREEN:return-s[this.getIndex(t.r1,t.g0,t.b1)]+s[this.getIndex(t.r1,t.g0,t.b0)]+s[this.getIndex(t.r0,t.g0,t.b1)]-s[this.getIndex(t.r0,t.g0,t.b0)];case B.BLUE:return-s[this.getIndex(t.r1,t.g1,t.b0)]+s[this.getIndex(t.r1,t.g0,t.b0)]+s[this.getIndex(t.r0,t.g1,t.b0)]-s[this.getIndex(t.r0,t.g0,t.b0)];default:throw new Error("unexpected direction $direction")}}top(t,e,s,a){switch(e){case B.RED:return a[this.getIndex(s,t.g1,t.b1)]-a[this.getIndex(s,t.g1,t.b0)]-a[this.getIndex(s,t.g0,t.b1)]+a[this.getIndex(s,t.g0,t.b0)];case B.GREEN:return a[this.getIndex(t.r1,s,t.b1)]-a[this.getIndex(t.r1,s,t.b0)]-a[this.getIndex(t.r0,s,t.b1)]+a[this.getIndex(t.r0,s,t.b0)];case B.BLUE:return a[this.getIndex(t.r1,t.g1,s)]-a[this.getIndex(t.r1,t.g0,s)]-a[this.getIndex(t.r0,t.g1,s)]+a[this.getIndex(t.r0,t.g0,s)];default:throw new Error("unexpected direction $direction")}}getIndex(t,e,s){return(t<<H*2)+(t<<H+1)+t+(e<<H)+e+s}}class Jt{constructor(t=0,e=0,s=0,a=0,i=0,o=0,r=0){this.r0=t,this.r1=e,this.g0=s,this.g1=a,this.b0=i,this.b1=o,this.vol=r}}class Zt{constructor(t,e){this.requestedCount=t,this.resultCount=e}}class Yt{constructor(t,e){this.cutLocation=t,this.maximum=e}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{static quantize(t,e){const a=new Xt().quantize(t,e);return Kt.quantize(t,a,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ee(v){const t=await new Promise((o,r)=>{const m=document.createElement("canvas"),b=m.getContext("2d");if(!b){r(new Error("Could not get canvas context"));return}const h=()=>{m.width=v.width,m.height=v.height,b.drawImage(v,0,0);let A=[0,0,v.width,v.height];const f=v.dataset.area;f&&/^\d+(\s*,\s*\d+){3}$/.test(f)&&(A=f.split(/\s*,\s*/).map(d=>parseInt(d,10)));const[u,g,w,T]=A;o(b.getImageData(u,g,w,T).data)},I=()=>{r(new Error("Image load failed"))};v.complete?h():(v.onload=h,v.onerror=I)}),e=[];for(let o=0;o<t.length;o+=4){const r=t[o],m=t[o+1],b=t[o+2];if(t[o+3]<255)continue;const I=bt(r,m,b);e.push(I)}const s=te.quantize(e,128);return Ct.score(s)[0]}const se=async v=>{const t=z(v),e=await ee(t[0]);return wt(e)},ot=()=>Z("OK"),lt=()=>Z("Cancel"),ne=v=>{const t=Object.assign({},{confirmText:ot(),cancelText:lt(),onConfirm:U,onCancel:U,validator:U,textFieldOptions:{}},v),e=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions","queue","onOpen","onOpened","onClose","onClosed","onOverlayClick"],s=new At;return Object.entries(t.textFieldOptions).forEach(([a,i])=>{s[a]=i}),new Promise((a,i)=>{let o=!1;const r=ct({...Object.fromEntries(e.filter(m=>!ut(t[m])).map(m=>[m,t[m]])),body:s,actions:[{text:t.cancelText,onClick:m=>t.onCancel.call(m,s.value,m)},{text:t.confirmText,onClick:m=>{const b=()=>{const I=t.onConfirm.call(m,s.value,m);return X(I)?I.then(()=>{o=!0}):I!==!1&&(o=!0),I};if(s.setCustomValidity(""),!s.reportValidity())return!1;const h=t.validator.call(s,s.value);return Et(h)&&!h?(s.setCustomValidity(" "),!1):Rt(h)?(s.setCustomValidity(h),!1):X(h)?new Promise((I,A)=>{h.then(I).catch(f=>{s.setCustomValidity(f),A(f)})}):b()}}]});v.confirmText||J(r,()=>{z(r).find('[slot="action"]').last().text(ot())}),v.cancelText||J(r,()=>{z(r).find('[slot="action"]').first().text(lt())}),z(r).on("close",m=>{m.target===r&&(o?a(s.value):i(),dt(r))})})},ae=(v,t=0)=>{const e=Ot();let s,a;return function(...i){return s===void 0&&(s=e.setTimeout(()=>{a=v.apply(this,i),s=void 0},t)),a}},ie={class:"content"},re=["value"],oe={key:0},le=["checked"],ue={key:0},de={key:1},ce=["disabled"],me={key:3},he={key:4},fe=["value"],ge=["value"],ve={key:1,class:"appearance-card"},pe={key:0},xe={key:1},Ie={key:2},ye=["value"],ke=["value"],Ce={class:"color-scheme"},be=["disabled"],we={key:3,class:"error-info"},Ae={key:4},Ee=["value"],Re=["value"],Oe=["disabled"],Te=["disabled"],Be=["disabled"],Ge={key:5,class:"error-info"},Me=Tt({__name:"SettingView",setup(v){Bt();var t=Gt(),e=t.get("username"),s=new Y.Object("UserInfo"),a=N(""),i=N(t.get("email")),o=new Y.Object("Email"),r=N(!1),m=N(t.get("emailVerified")),b=N(!1),h=N(!1);Mt().then(c=>{s=c,a.value=s.get("nickname")}),Nt().then(c=>{o=c,r.value=o.getACL().getPublicReadAccess()}),F(a,c=>{s.set("nickname",c)}),F(i,c=>{t.set("email",c),o.set("email",c),m.value=!1,b.value=!1,h.value=!1});function I(c){console.log(c),r.value=c,o.getACL().setPublicReadAccess(c),o.save().then(()=>{K("邮箱隐私设置已更新！",!0)}).catch(n=>{K("更新邮箱隐私设置时出现问题。",!0)})}function A(){Y.User.requestEmailVerify(i.value).then(()=>{b.value=!0}).catch(c=>{h.value=!0})}var f=N(nt),u=N({...st().value}),g=N(u.value.name),w=N(u.value.name),T=Lt(()=>JSON.stringify(f.value.find(c=>c.name===g.value))!==JSON.stringify(u.value));F(zt,c=>{c&&(f.value=nt,u.value={...st().value},g.value=u.value.name,w.value=u.value.name)});var d=N(u.value.backgroundImage);F(g,c=>{var n=f.value.find(l=>l.name===c);n&&(u.value={...n},d.value=n.backgroundImage)}),F(u,c=>{Ft(c)},{deep:!0});var k=ae(c=>{u.value.backgroundImage=c},1e3);F(d,(c,n)=>{c?n?k(c):(u.value.backgroundImageOpacity=.3,u.value.sidebarOpacity=.7,u.value.backgroundImage=c):(u.value.backgroundImageOpacity=0,u.value.sidebarOpacity=1)});var E=N("");function S(){E.value="";var c=new Image;c.src=u.value.backgroundImage,c.crossOrigin="anonymous",c.onload=()=>{se(c).then(n=>{u.value.colorScheme=n}).catch(n=>{E.value=n.message})},c.onerror=n=>{E.value="无法加载背景图片。可能是跨域问题或图片不存在。"}}var G=N("");function p(){G.value="";var c=f.value.find(l=>l.name===g.value);if(c){var n=f.value.find(l=>l.name===u.value.name);if(n&&n!==c){G.value="主题名已存在";return}Object.assign(c,{...u.value})}else console.log("pushed"),f.value.push({...u.value});w.value===g.value&&(w.value=u.value.name),g.value=u.value.name}function C(){ne({headline:"另存为新的主题",description:"在此处键入主题名",confirmText:"完成",cancelText:"取消",onConfirm:c=>{if(!c){G.value="主题名不能为空";return}if(f.value.some(l=>l.name===c)){G.value="主题名已存在。";return}var n={...u.value,name:c,isGeneral:!1};f.value.push(n),g.value=c}})}function M(){w.value=g.value}function q(){$t({headline:"确认要删除主题吗？",description:"此操作不可撤销",confirmText:"删除",cancelText:"取消",onConfirm:()=>{var c;f.value=f.value.filter(n=>n.name!==g.value),g.value==w.value&&(w.value=((c=f.value.find(n=>n.isGeneral))==null?void 0:c.name)||""),g.value=w.value}})}async function V(){var c=!1;await s.save().catch(n=>{c=!0}),await o.save().catch(n=>{c=!0}),await Dt().then(async n=>{n.set("customAppearance",f.value.filter(l=>!l.isGeneral).map(l=>({name:l.name,theme:l.theme,backgroundImage:l.backgroundImage,colorScheme:l.colorScheme,backgroundImageOpacity:l.backgroundImageOpacity,sidebarOpacity:l.sidebarOpacity}))),n.set("activeAppearance",w.value),await n.save().catch(l=>{c=!0})}),c?K("保存时出现问题。",!0):K("保存成功！",!0)}return St(()=>{V()}),(c,n)=>(O(),R("div",ie,[n[24]||(n[24]=y("h1",null,"设置",-1)),y("mdui-button",{onClick:n[0]||(n[0]=l=>V())},"保存设置"),n[25]||(n[25]=y("h2",null,"全局设置",-1)),y("mdui-text-field",{label:"用户名",variant:"outlined",readonly:"",value:x(e)},null,8,re),$(y("mdui-text-field",{label:"昵称","onUpdate:modelValue":n[1]||(n[1]=l=>_(a)?a.value=l:a=l)},null,512),[[P,x(a)]]),$(y("mdui-text-field",{label:"邮箱","onUpdate:modelValue":n[2]||(n[2]=l=>_(i)?i.value=l:i=l)},null,512),[[P,x(i)]]),x(i)?(O(),R("div",oe,[y("mdui-checkbox",{checked:x(r),onInput:n[3]||(n[3]=l=>I(!l.target.checked))},"公开邮箱",40,le),n[18]||(n[18]=W(" 邮箱状态：")),x(m)?(O(),R("span",ue,"已验证✔")):(O(),R("span",de,"未验证❌")),x(m)?D("",!0):(O(),R("mdui-button",{key:2,onClick:n[4]||(n[4]=l=>A()),disabled:x(b)},"邮箱验证",8,ce)),x(b)?(O(),R("span",me,"验证邮件已发送")):D("",!0),x(h)?(O(),R("span",he,"发送验证邮件失败")):D("",!0)])):D("",!0),n[26]||(n[26]=y("h2",null,"游戏设置",-1)),n[27]||(n[27]=y("mdui-checkbox",null,"自动禁用不可用手势",-1)),n[28]||(n[28]=y("h3",null,"自定义手势",-1)),n[29]||(n[29]=y("h2",null,"外观",-1)),n[30]||(n[30]=y("h3",null,"主题",-1)),y("mdui-select",{label:"选择主题",value:x(g),onChange:n[5]||(n[5]=l=>_(g)?g.value=l.target.value:g=l.target.value)},[(O(!0),R(qt,null,Vt(x(f),l=>(O(),R("mdui-menu-item",{value:l.name},tt(l.name),9,ge))),256)),n[19]||(n[19]=y("mdui-button-icon",{slot:"end-icon"},[y("mdui-icon-keyboard-arrow-down")],-1))],40,fe),x(g)?(O(),R("mdui-card",ve,[x(u).isGeneral?(O(),R("span",pe,"系统主题")):(O(),R("span",xe,"自定义主题")),x(g)==x(w)?(O(),R("span",Ie," 已应用✔")):D("",!0),$(y("mdui-text-field",{label:"主题名称","onUpdate:modelValue":n[6]||(n[6]=l=>x(u).name=l)},null,512),[[P,x(u).name]]),y("mdui-select",{label:"深色/浅色模式",value:x(u).theme,onChange:n[7]||(n[7]=l=>x(u).theme=l.target.value)},n[20]||(n[20]=[y("mdui-menu-item",{value:"auto"},"跟随系统",-1),y("mdui-menu-item",{value:"light"},"浅色模式",-1),y("mdui-menu-item",{value:"dark"},"深色模式",-1),y("mdui-button-icon",{slot:"end-icon"},[y("mdui-icon-keyboard-arrow-down")],-1)]),40,ye),y("mdui-text-field",{label:"背景图片URL",value:x(d),onInput:n[8]||(n[8]=l=>_(d)?d.value=l.target.value:d=l.target.value)},null,40,ke),y("div",Ce,[n[21]||(n[21]=W(" 配色方案：")),$(y("input",{type:"color","onUpdate:modelValue":n[9]||(n[9]=l=>x(u).colorScheme=l)},null,512),[[P,x(u).colorScheme]]),y("mdui-button",{onClick:n[10]||(n[10]=l=>S()),disabled:!x(u).backgroundImage},"从背景图片中提取",8,be)]),x(E)?(O(),R("div",we,"提取失败。错误："+tt(x(E)),1)):D("",!0),x(d)?(O(),R("div",Ae,[n[22]||(n[22]=W(" 背景图片不透明度： ")),y("mdui-slider",{tickmarks:"",max:"10",step:"1",value:x(u).backgroundImageOpacity*10,onInput:n[11]||(n[11]=l=>x(u).backgroundImageOpacity=l.target.value/10)},null,40,Ee),n[23]||(n[23]=W(" 侧边栏不透明度： ")),y("mdui-slider",{tickmarks:"",max:"10",step:"1",value:x(u).sidebarOpacity*10,onInput:n[12]||(n[12]=l=>x(u).sidebarOpacity=l.target.value/10)},null,40,Re)])):D("",!0),y("mdui-button",{onClick:n[13]||(n[13]=l=>p()),disabled:!x(T)||x(u).isGeneral},"保存主题",8,Oe),y("mdui-button",{onClick:n[14]||(n[14]=l=>C())},"另存为新的主题"),y("mdui-button",{onClick:n[15]||(n[15]=l=>M()),disabled:x(g)==x(w)},"应用该主题",8,Te),y("mdui-button",{onClick:n[16]||(n[16]=l=>q()),disabled:x(u).isGeneral},"删除主题",8,Be),x(G)?(O(),R("div",Ge,"保存失败。"+tt(x(G)),1)):D("",!0)])):D("",!0),y("mdui-button",{onClick:n[17]||(n[17]=l=>V())},"保存设置")]))}}),Le=Ut(Me,[["__scopeId","data-v-ffde5c75"]]);export{Le as default};
