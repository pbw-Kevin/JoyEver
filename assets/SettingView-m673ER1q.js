import{U as Oe,$ as D,V as Te,W as Q,X as te,Y as Be,Z as Se,a0 as be,a1 as se,a2 as we,a3 as ne,a4 as Me,a5 as Ge,a6 as Ne,a7 as ze,a8 as Le,a9 as Ve,aa as qe,ab as Ue,ac as Pe,ad as De,ae as Fe,af as je,ag as _e,s as ue,g as de,h as ce,j as me,k as he,d as $e,y as We,K as He,ah as ae,C as B,N as Ke,S as Qe,ai as _,aj as ie,p as Xe,ak as Je,c as S,a as d,b as j,al as $,e as q,u as p,am as W,an as H,t as K,F as Ze,q as Ye,ao as et,ap as J,aq as tt,ar as st,as as nt,o as M,at as fe,au as at,_ as it}from"./index-BiTin0vQ.js";const rt={onClick:Q},ve="mdui.functions.dialog.";let Y;const ke=v=>{const e=new Oe,t=D(e),n=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions"],a=["onOpen","onOpened","onClose","onClosed","onOverlayClick"];return Object.entries(v).forEach(([r,u])=>{if(n.includes(r))e[r]=u;else if(a.includes(r)){const o=Te(r.slice(2));t.on(o,h=>{h.target===e&&u.call(e,e)})}}),v.body&&t.append(v.body),v.actions&&v.actions.forEach(r=>{const u=Object.assign({},rt,r);D(`<mdui-button
        slot="action"
        variant="text"
      >${u.text}</mdui-button>`).appendTo(t).on("click",function(){const o=u.onClick.call(e,e);te(o)?(this.loading=!0,o.then(()=>{e.open=!1}).finally(()=>{this.loading=!1})):o!==!1&&(e.open=!1)})}),t.appendTo("body").on("closed",r=>{r.target===e&&(t.remove(),v.queue&&(Y=void 0,Be(ve+v.queue)))}),v.queue?Y?Se(ve+v.queue,()=>{e.open=!0,Y=e}):(setTimeout(()=>{e.open=!0}),Y=e):setTimeout(()=>{e.open=!0}),e},pe=()=>ne("OK"),xe=()=>ne("Cancel"),ot=v=>{const e=Object.assign({},{confirmText:pe(),cancelText:xe(),onConfirm:Q,onCancel:Q},v),t=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions","queue","onOpen","onOpened","onClose","onClosed","onOverlayClick"];return new Promise((n,a)=>{let r=!1;const u=ke({...Object.fromEntries(t.filter(o=>!be(e[o])).map(o=>[o,e[o]])),actions:[{text:e.cancelText,onClick:o=>e.onCancel.call(o,o)},{text:e.confirmText,onClick:o=>{const h=e.onConfirm.call(o,o);return te(h)?h.then(()=>{r=!0}):h!==!1&&(r=!0),h}}]});v.confirmText||se(u,()=>{D(u).find('[slot="action"]').last().text(pe())}),v.cancelText||se(u,()=>{D(u).find('[slot="action"]').first().text(xe())}),D(u).on("close",o=>{o.target===u&&(r?n():a(),we(u))})})};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{fromInt(e){return Me(e)}toInt(e){return Ge(e[0],e[1],e[2])}distance(e,t){const n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return n*n+a*a+r*r}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ut=10,dt=3;class ct{static quantize(e,t,n){const a=new Map,r=new Array,u=new Array,o=new lt;let h=0;for(let c=0;c<e.length;c++){const y=e[c],T=a.get(y);T===void 0?(h++,r.push(o.fromInt(y)),u.push(y),a.set(y,1)):a.set(y,T+1)}const k=new Array;for(let c=0;c<h;c++){const y=u[c],T=a.get(y);T!==void 0&&(k[c]=T)}let g=Math.min(n,h);t.length>0&&(g=Math.min(g,t.length));const x=new Array;for(let c=0;c<t.length;c++)x.push(o.fromInt(t[c]));const b=g-x.length;if(t.length===0&&b>0)for(let c=0;c<b;c++){const y=Math.random()*100,T=Math.random()*201+-100,L=Math.random()*201+-100;x.push(new Array(y,T,L))}const I=new Array;for(let c=0;c<h;c++)I.push(Math.floor(Math.random()*g));const E=new Array;for(let c=0;c<g;c++){E.push(new Array);for(let y=0;y<g;y++)E[c].push(0)}const w=new Array;for(let c=0;c<g;c++){w.push(new Array);for(let y=0;y<g;y++)w[c].push(new mt)}const C=new Array;for(let c=0;c<g;c++)C.push(0);for(let c=0;c<ut;c++){for(let i=0;i<g;i++){for(let f=i+1;f<g;f++){const A=o.distance(x[i],x[f]);w[f][i].distance=A,w[f][i].index=i,w[i][f].distance=A,w[i][f].index=f}w[i].sort();for(let f=0;f<g;f++)E[i][f]=w[i][f].index}let y=0;for(let i=0;i<h;i++){const f=r[i],A=I[i],V=x[A],N=o.distance(f,V);let X=N,U=-1;for(let F=0;F<g;F++){if(w[A][F].distance>=4*N)continue;const P=o.distance(f,x[F]);P<X&&(X=P,U=F)}U!==-1&&Math.abs(Math.sqrt(X)-Math.sqrt(N))>dt&&(y++,I[i]=U)}if(y===0&&c!==0)break;const T=new Array(g).fill(0),L=new Array(g).fill(0),R=new Array(g).fill(0);for(let i=0;i<g;i++)C[i]=0;for(let i=0;i<h;i++){const f=I[i],A=r[i],V=k[i];C[f]+=V,T[f]+=A[0]*V,L[f]+=A[1]*V,R[f]+=A[2]*V}for(let i=0;i<g;i++){const f=C[i];if(f===0){x[i]=[0,0,0];continue}const A=T[i]/f,V=L[i]/f,N=R[i]/f;x[i]=[A,V,N]}}const O=new Map;for(let c=0;c<g;c++){const y=C[c];if(y===0)continue;const T=o.toInt(x[c]);O.has(T)||O.set(T,y)}return O}}class mt{constructor(){this.distance=-1,this.index=-1}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{static quantize(e){const t=new Map;for(let n=0;n<e.length;n++){const a=e[n];Ne(a)<255||t.set(a,(t.get(a)??0)+1)}return t}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=5,z=33,Z=35937,G={RED:"red",GREEN:"green",BLUE:"blue"};class gt{constructor(e=[],t=[],n=[],a=[],r=[],u=[]){this.weights=e,this.momentsR=t,this.momentsG=n,this.momentsB=a,this.moments=r,this.cubes=u}quantize(e,t){this.constructHistogram(e),this.computeMoments();const n=this.createBoxes(t);return this.createResult(n.resultCount)}constructHistogram(e){this.weights=Array.from({length:Z}).fill(0),this.momentsR=Array.from({length:Z}).fill(0),this.momentsG=Array.from({length:Z}).fill(0),this.momentsB=Array.from({length:Z}).fill(0),this.moments=Array.from({length:Z}).fill(0);const t=ht.quantize(e);for(const[n,a]of t.entries()){const r=ze(n),u=Le(n),o=Ve(n),h=8-ee,k=(r>>h)+1,g=(u>>h)+1,x=(o>>h)+1,b=this.getIndex(k,g,x);this.weights[b]=(this.weights[b]??0)+a,this.momentsR[b]+=a*r,this.momentsG[b]+=a*u,this.momentsB[b]+=a*o,this.moments[b]+=a*(r*r+u*u+o*o)}}computeMoments(){for(let e=1;e<z;e++){const t=Array.from({length:z}).fill(0),n=Array.from({length:z}).fill(0),a=Array.from({length:z}).fill(0),r=Array.from({length:z}).fill(0),u=Array.from({length:z}).fill(0);for(let o=1;o<z;o++){let h=0,k=0,g=0,x=0,b=0;for(let I=1;I<z;I++){const E=this.getIndex(e,o,I);h+=this.weights[E],k+=this.momentsR[E],g+=this.momentsG[E],x+=this.momentsB[E],b+=this.moments[E],t[I]+=h,n[I]+=k,a[I]+=g,r[I]+=x,u[I]+=b;const w=this.getIndex(e-1,o,I);this.weights[E]=this.weights[w]+t[I],this.momentsR[E]=this.momentsR[w]+n[I],this.momentsG[E]=this.momentsG[w]+a[I],this.momentsB[E]=this.momentsB[w]+r[I],this.moments[E]=this.moments[w]+u[I]}}}}createBoxes(e){this.cubes=Array.from({length:e}).fill(0).map(()=>new ft);const t=Array.from({length:e}).fill(0);this.cubes[0].r0=0,this.cubes[0].g0=0,this.cubes[0].b0=0,this.cubes[0].r1=z-1,this.cubes[0].g1=z-1,this.cubes[0].b1=z-1;let n=e,a=0;for(let r=1;r<e;r++){this.cut(this.cubes[a],this.cubes[r])?(t[a]=this.cubes[a].vol>1?this.variance(this.cubes[a]):0,t[r]=this.cubes[r].vol>1?this.variance(this.cubes[r]):0):(t[a]=0,r--),a=0;let u=t[0];for(let o=1;o<=r;o++)t[o]>u&&(u=t[o],a=o);if(u<=0){n=r+1;break}}return new vt(e,n)}createResult(e){const t=[];for(let n=0;n<e;++n){const a=this.cubes[n],r=this.volume(a,this.weights);if(r>0){const u=Math.round(this.volume(a,this.momentsR)/r),o=Math.round(this.volume(a,this.momentsG)/r),h=Math.round(this.volume(a,this.momentsB)/r),k=255<<24|(u&255)<<16|(o&255)<<8|h&255;t.push(k)}}return t}variance(e){const t=this.volume(e,this.momentsR),n=this.volume(e,this.momentsG),a=this.volume(e,this.momentsB),r=this.moments[this.getIndex(e.r1,e.g1,e.b1)]-this.moments[this.getIndex(e.r1,e.g1,e.b0)]-this.moments[this.getIndex(e.r1,e.g0,e.b1)]+this.moments[this.getIndex(e.r1,e.g0,e.b0)]-this.moments[this.getIndex(e.r0,e.g1,e.b1)]+this.moments[this.getIndex(e.r0,e.g1,e.b0)]+this.moments[this.getIndex(e.r0,e.g0,e.b1)]-this.moments[this.getIndex(e.r0,e.g0,e.b0)],u=t*t+n*n+a*a,o=this.volume(e,this.weights);return r-u/o}cut(e,t){const n=this.volume(e,this.momentsR),a=this.volume(e,this.momentsG),r=this.volume(e,this.momentsB),u=this.volume(e,this.weights),o=this.maximize(e,G.RED,e.r0+1,e.r1,n,a,r,u),h=this.maximize(e,G.GREEN,e.g0+1,e.g1,n,a,r,u),k=this.maximize(e,G.BLUE,e.b0+1,e.b1,n,a,r,u);let g;const x=o.maximum,b=h.maximum,I=k.maximum;if(x>=b&&x>=I){if(o.cutLocation<0)return!1;g=G.RED}else b>=x&&b>=I?g=G.GREEN:g=G.BLUE;switch(t.r1=e.r1,t.g1=e.g1,t.b1=e.b1,g){case G.RED:e.r1=o.cutLocation,t.r0=e.r1,t.g0=e.g0,t.b0=e.b0;break;case G.GREEN:e.g1=h.cutLocation,t.r0=e.r0,t.g0=e.g1,t.b0=e.b0;break;case G.BLUE:e.b1=k.cutLocation,t.r0=e.r0,t.g0=e.g0,t.b0=e.b1;break;default:throw new Error("unexpected direction "+g)}return e.vol=(e.r1-e.r0)*(e.g1-e.g0)*(e.b1-e.b0),t.vol=(t.r1-t.r0)*(t.g1-t.g0)*(t.b1-t.b0),!0}maximize(e,t,n,a,r,u,o,h){const k=this.bottom(e,t,this.momentsR),g=this.bottom(e,t,this.momentsG),x=this.bottom(e,t,this.momentsB),b=this.bottom(e,t,this.weights);let I=0,E=-1,w=0,C=0,O=0,c=0;for(let y=n;y<a;y++){if(w=k+this.top(e,t,y,this.momentsR),C=g+this.top(e,t,y,this.momentsG),O=x+this.top(e,t,y,this.momentsB),c=b+this.top(e,t,y,this.weights),c===0)continue;let T=(w*w+C*C+O*O)*1,L=c*1,R=T/L;w=r-w,C=u-C,O=o-O,c=h-c,c!==0&&(T=(w*w+C*C+O*O)*1,L=c*1,R+=T/L,R>I&&(I=R,E=y))}return new pt(E,I)}volume(e,t){return t[this.getIndex(e.r1,e.g1,e.b1)]-t[this.getIndex(e.r1,e.g1,e.b0)]-t[this.getIndex(e.r1,e.g0,e.b1)]+t[this.getIndex(e.r1,e.g0,e.b0)]-t[this.getIndex(e.r0,e.g1,e.b1)]+t[this.getIndex(e.r0,e.g1,e.b0)]+t[this.getIndex(e.r0,e.g0,e.b1)]-t[this.getIndex(e.r0,e.g0,e.b0)]}bottom(e,t,n){switch(t){case G.RED:return-n[this.getIndex(e.r0,e.g1,e.b1)]+n[this.getIndex(e.r0,e.g1,e.b0)]+n[this.getIndex(e.r0,e.g0,e.b1)]-n[this.getIndex(e.r0,e.g0,e.b0)];case G.GREEN:return-n[this.getIndex(e.r1,e.g0,e.b1)]+n[this.getIndex(e.r1,e.g0,e.b0)]+n[this.getIndex(e.r0,e.g0,e.b1)]-n[this.getIndex(e.r0,e.g0,e.b0)];case G.BLUE:return-n[this.getIndex(e.r1,e.g1,e.b0)]+n[this.getIndex(e.r1,e.g0,e.b0)]+n[this.getIndex(e.r0,e.g1,e.b0)]-n[this.getIndex(e.r0,e.g0,e.b0)];default:throw new Error("unexpected direction $direction")}}top(e,t,n,a){switch(t){case G.RED:return a[this.getIndex(n,e.g1,e.b1)]-a[this.getIndex(n,e.g1,e.b0)]-a[this.getIndex(n,e.g0,e.b1)]+a[this.getIndex(n,e.g0,e.b0)];case G.GREEN:return a[this.getIndex(e.r1,n,e.b1)]-a[this.getIndex(e.r1,n,e.b0)]-a[this.getIndex(e.r0,n,e.b1)]+a[this.getIndex(e.r0,n,e.b0)];case G.BLUE:return a[this.getIndex(e.r1,e.g1,n)]-a[this.getIndex(e.r1,e.g0,n)]-a[this.getIndex(e.r0,e.g1,n)]+a[this.getIndex(e.r0,e.g0,n)];default:throw new Error("unexpected direction $direction")}}getIndex(e,t,n){return(e<<ee*2)+(e<<ee+1)+e+(t<<ee)+t+n}}class ft{constructor(e=0,t=0,n=0,a=0,r=0,u=0,o=0){this.r0=e,this.r1=t,this.g0=n,this.g1=a,this.b0=r,this.b1=u,this.vol=o}}class vt{constructor(e,t){this.requestedCount=e,this.resultCount=t}}class pt{constructor(e,t){this.cutLocation=e,this.maximum=t}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{static quantize(e,t){const a=new gt().quantize(e,t);return ct.quantize(e,a,t)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function It(v){const e=await new Promise((u,o)=>{const h=document.createElement("canvas"),k=h.getContext("2d");if(!k){o(new Error("Could not get canvas context"));return}const g=()=>{h.width=v.width,h.height=v.height,k.drawImage(v,0,0);let b=[0,0,v.width,v.height];const I=v.dataset.area;I&&/^\d+(\s*,\s*\d+){3}$/.test(I)&&(b=I.split(/\s*,\s*/).map(c=>parseInt(c,10)));const[E,w,C,O]=b;u(k.getImageData(E,w,C,O).data)},x=()=>{o(new Error("Image load failed"))};v.complete?g():(v.onload=g,v.onerror=x)}),t=[];for(let u=0;u<e.length;u+=4){const o=e[u],h=e[u+1],k=e[u+2];if(e[u+3]<255)continue;const x=Ue(o,h,k);t.push(x)}const n=xt.quantize(t,128);return qe.score(n)[0]}const yt=async v=>{const e=D(v),t=await It(e[0]);return Pe(t)},Ie=()=>ne("OK"),ye=()=>ne("Cancel"),bt=v=>{const e=Object.assign({},{confirmText:Ie(),cancelText:ye(),onConfirm:Q,onCancel:Q,validator:Q,textFieldOptions:{}},v),t=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions","queue","onOpen","onOpened","onClose","onClosed","onOverlayClick"],n=new De;return Object.entries(e.textFieldOptions).forEach(([a,r])=>{n[a]=r}),new Promise((a,r)=>{let u=!1;const o=ke({...Object.fromEntries(t.filter(h=>!be(e[h])).map(h=>[h,e[h]])),body:n,actions:[{text:e.cancelText,onClick:h=>e.onCancel.call(h,n.value,h)},{text:e.confirmText,onClick:h=>{const k=()=>{const x=e.onConfirm.call(h,n.value,h);return te(x)?x.then(()=>{u=!0}):x!==!1&&(u=!0),x};if(n.setCustomValidity(""),!n.reportValidity())return!1;const g=e.validator.call(n,n.value);return Fe(g)&&!g?(n.setCustomValidity(" "),!1):je(g)?(n.setCustomValidity(g),!1):te(g)?new Promise((x,b)=>{g.then(x).catch(I=>{n.setCustomValidity(I),b(I)})}):k()}}]});v.confirmText||se(o,()=>{D(o).find('[slot="action"]').last().text(Ie())}),v.cancelText||se(o,()=>{D(o).find('[slot="action"]').first().text(ye())}),D(o).on("close",h=>{h.target===o&&(u?a(n.value):r(),we(o))})})},wt=(v,e=0)=>{const t=_e();let n,a;return function(...r){return n===void 0&&(n=t.setTimeout(()=>{a=v.apply(this,r),n=void 0},e)),a}};let re=class extends me{render(){return he('<path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>')}};re.styles=ue;re=de([ce("mdui-icon-settings")],re);let oe=class extends me{render(){return he('<path d="M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>')}};oe.styles=ue;oe=de([ce("mdui-icon-security")],oe);let le=class extends me{render(){return he('<path d="M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10a2.5 2.5 0 0 0 2.5-2.5c0-.61-.23-1.2-.64-1.67a.528.528 0 0 1-.13-.33c0-.28.22-.5.5-.5H16c3.31 0 6-2.69 6-6 0-4.96-4.49-9-10-9zm5.5 11c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm-3-4c-.83 0-1.5-.67-1.5-1.5S13.67 6 14.5 6s1.5.67 1.5 1.5S15.33 9 14.5 9zM5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S7.33 13 6.5 13 5 12.33 5 11.5zm6-4c0 .83-.67 1.5-1.5 1.5S8 8.33 8 7.5 8.67 6 9.5 6s1.5.67 1.5 1.5z"/>')}};le.styles=ue;le=de([ce("mdui-icon-palette")],le);const kt={class:"content"},Ct={value:"global","full-width":"",variant:"secondary"},At={slot:"panel",value:"global"},Et=["value"],Rt={slot:"helper",class:"error-info"},Ot={key:0},Tt=["checked"],Bt={key:0},St={key:1},Mt=["disabled"],Gt={key:3},Nt={key:4},zt={slot:"panel",value:"security"},Lt={slot:"helper",class:"error-info"},Vt={slot:"helper",class:"error-info"},qt={key:0},Ut={slot:"panel",value:"appearance"},Pt=["value"],Dt=["value"],Ft={key:0,class:"appearance-card"},jt={key:0},_t={key:1},$t={key:2},Wt=["value"],Ht=["value"],Kt={class:"color-scheme"},Qt=["disabled"],Xt={key:3,class:"error-info"},Jt={key:4},Zt=["value"],Yt=["value"],es=["disabled"],ts=["disabled"],ss=["disabled"],ns={key:5,class:"error-info"},as=$e({__name:"SettingView",setup(v){We();var e=He(),t=e.getUsername(),n=new ae.Object("UserInfo"),a=B(""),r=B(e.get("email")),u=B(!!r.value),o=new ae.Object("Email"),h=B(!1),k=B(e.get("emailVerified")),g=B(!1),x=B(!1);Ke().then(m=>{n=m,a.value=n.get("nickname")}),Qe().then(m=>{o=m,h.value=o.getACL().getPublicReadAccess()}),_(a,m=>{n.set("nickname",m)});var b=B("");function I(){if(b.value="",r.value&&!et(r.value)){b.value="邮箱格式不正确。";return}e.setEmail(r.value),e.save().then(m=>(k.value=m.get("emailVerified"),u.value=!!r.value,o.set("email",r.value))).then(()=>{J("邮箱已保存！",!0)}).catch(m=>{if(m.code==203){b.value="邮箱已被使用。请尝试其他邮箱。";return}b.value="保存邮箱时出现问题。"}),g.value=!1,x.value=!1}_(r,()=>{b.value=""});function E(m){h.value=m,o.getACL().setPublicReadAccess(m),o.save().then(()=>{J("邮箱隐私设置已更新！",!0)}).catch(s=>{J("更新邮箱隐私设置时出现问题。",!0)})}function w(){ae.User.requestEmailVerify(r.value).then(()=>{g.value=!0}).catch(m=>{x.value=!0})}var C=B(""),O=B(""),c=B({password:"",passwordAgain:""}),y=B(!1);function T(){if(c.value={password:"",passwordAgain:""},y.value=!1,C.value)if(tt(C.value))if(C.value!==O.value){c.value.passwordAgain="两次输入的密码不一致。";return}else e.setPassword(C.value),y.value=!0;else{c.value.password="密码格式不正确。密码的长度应至少为 8 个字符，且不为空白字符。";return}else{c.value.password="请填写密码。";return}}var L=ie(),R=B(fe),i=B({...ie().value}),f=B(i.value.name),A=B(i.value.name),V=Xe(()=>JSON.stringify(R.value.find(m=>m.name===f.value))!==JSON.stringify(i.value));_(at,m=>{m&&(R.value=fe,i.value={...ie().value},f.value=i.value.name,A.value=i.value.name)});var N=B(i.value.backgroundImage);_(f,m=>{var s=R.value.find(l=>l.name===m);s&&(i.value={...s},N.value=s.backgroundImage)}),_(i,m=>{L.value={...m}},{deep:!0});var X=wt(m=>{i.value.backgroundImage=m},1e3);_(N,(m,s)=>{m?s?X(m):(i.value.backgroundImageOpacity=.3,i.value.sidebarOpacity=.7,i.value.backgroundImage=m):(i.value.backgroundImageOpacity=0,i.value.sidebarOpacity=1)});var U=B("");function F(){U.value="";var m=new Image;m.src=i.value.backgroundImage,m.crossOrigin="anonymous",m.onload=()=>{yt(m).then(s=>{i.value.colorScheme=s}).catch(s=>{U.value=s.message})},m.onerror=s=>{U.value="无法加载背景图片。可能是跨域问题或图片不存在。"}}var P=B("");function Ce(){P.value="";var m=R.value.find(l=>l.name===f.value);if(m){var s=R.value.find(l=>l.name===i.value.name);if(s&&s!==m){P.value="主题名已存在";return}Object.assign(m,{...i.value})}else R.value.push({...i.value});A.value===f.value&&(A.value=i.value.name),f.value=i.value.name}function Ae(){bt({headline:"另存为新的主题",description:"在此处键入主题名",confirmText:"完成",cancelText:"取消",onConfirm:m=>{if(!m){P.value="主题名不能为空";return}if(R.value.some(l=>l.name===m)){P.value="主题名已存在。";return}var s={...i.value,name:m,isGeneral:!1};R.value.push(s),f.value=m}})}function Ee(){A.value=f.value,st(i.value)}function Re(){ot({headline:"确认要删除主题吗？",description:"此操作不可撤销",confirmText:"删除",cancelText:"取消",onConfirm:()=>{var m;R.value=R.value.filter(s=>s.name!==f.value),f.value==A.value&&(A.value=((m=R.value.find(s=>s.isGeneral))==null?void 0:m.name)||""),f.value=A.value}})}async function ge(){var m=!1;await e.save().catch(s=>{m=!0}),await n.save().catch(s=>{m=!0}),await o.save().catch(s=>{m=!0}),await nt().then(async s=>{s.set("customAppearance",R.value.filter(l=>!l.isGeneral).map(l=>({name:l.name,theme:l.theme,backgroundImage:l.backgroundImage,colorScheme:l.colorScheme,backgroundImageOpacity:l.backgroundImageOpacity,sidebarOpacity:l.sidebarOpacity}))),s.set("activeAppearance",A.value),await s.save().catch(l=>{m=!0})}),m?J("保存时出现问题。",!0):J("保存成功！",!0)}return Je(()=>{ge()}),(m,s)=>(M(),S("div",kt,[s[36]||(s[36]=d("h1",null,"设置",-1)),d("mdui-button",{onClick:s[0]||(s[0]=l=>ge())},"保存设置"),d("mdui-tabs",Ct,[s[31]||(s[31]=d("mdui-tab",{value:"global",inline:""},[j(" 全局设置 "),d("mdui-icon-settings",{slot:"icon"})],-1)),s[32]||(s[32]=d("mdui-tab",{value:"security",inline:""},[j(" 安全 "),d("mdui-icon-security",{slot:"icon"})],-1)),s[33]||(s[33]=d("mdui-tab",{value:"game",inline:""},[j(" 游戏设置 "),d("mdui-icon-videogame-asset",{slot:"icon"})],-1)),s[34]||(s[34]=d("mdui-tab",{value:"appearance",inline:""},[j(" 外观 "),d("mdui-icon-palette",{slot:"icon"})],-1)),d("mdui-tab-panel",At,[s[22]||(s[22]=d("h2",null,"全局设置",-1)),d("mdui-text-field",{label:"用户名",variant:"outlined",readonly:"",value:p(t)},null,8,Et),$(d("mdui-text-field",{label:"昵称","onUpdate:modelValue":s[1]||(s[1]=l=>H(a)?a.value=l:a=l)},null,512),[[W,p(a)]]),$(d("mdui-text-field",{type:"email",label:"邮箱","onUpdate:modelValue":s[2]||(s[2]=l=>H(r)?r.value=l:r=l)},[d("span",Rt,K(p(b)),1)],512),[[W,p(r)]]),d("mdui-button",{onClick:s[3]||(s[3]=l=>I())},"保存邮箱"),p(u)?(M(),S("div",Ot,[d("mdui-checkbox",{checked:p(h),onInput:s[4]||(s[4]=l=>E(!l.target.checked))},"公开邮箱",40,Tt),s[21]||(s[21]=j(" 邮箱状态：")),p(k)?(M(),S("span",Bt,"已验证✔")):(M(),S("span",St,"未验证❌")),p(k)?q("",!0):(M(),S("mdui-button",{key:2,onClick:s[5]||(s[5]=l=>w()),disabled:p(g)},"邮箱验证",8,Mt)),p(g)?(M(),S("span",Gt,"验证邮件已发送")):q("",!0),p(x)?(M(),S("span",Nt,"发送验证邮件失败")):q("",!0)])):q("",!0)]),d("mdui-tab-panel",zt,[s[23]||(s[23]=d("h2",null,"安全",-1)),$(d("mdui-text-field",{type:"password","toggle-password":"",label:"新密码","onUpdate:modelValue":s[6]||(s[6]=l=>H(C)?C.value=l:C=l)},[d("span",Lt,K(p(c).password),1)],512),[[W,p(C)]]),$(d("mdui-text-field",{type:"password","toggle-password":"",label:"确认新密码","onUpdate:modelValue":s[7]||(s[7]=l=>H(O)?O.value=l:O=l)},[d("span",Vt,K(p(c).passwordAgain),1)],512),[[W,p(O)]]),d("mdui-button",{onClick:s[8]||(s[8]=l=>T())},"更改密码"),p(y)?(M(),S("span",qt,"密码已更改！")):q("",!0)]),s[35]||(s[35]=d("mdui-tab-panel",{slot:"panel",value:"game"},[d("h2",null,"游戏设置"),d("mdui-checkbox",null,"公开历史记录"),d("br"),d("mdui-checkbox",null,"自动禁用不可用手势"),d("h3",null,"自定义手势"),d("p",null,"自定义手势会被自动判定为爆盾。")],-1)),d("mdui-tab-panel",Ut,[s[29]||(s[29]=d("h2",null,"外观",-1)),s[30]||(s[30]=d("h3",null,"主题",-1)),d("mdui-select",{label:"选择主题",value:p(f),onChange:s[9]||(s[9]=l=>H(f)?f.value=l.target.value:f=l.target.value)},[(M(!0),S(Ze,null,Ye(p(R),l=>(M(),S("mdui-menu-item",{value:l.name},K(l.name),9,Dt))),256)),s[24]||(s[24]=d("mdui-button-icon",{slot:"end-icon"},[d("mdui-icon-keyboard-arrow-down")],-1))],40,Pt),p(f)?(M(),S("mdui-card",Ft,[p(i).isGeneral?(M(),S("span",jt,"系统主题")):(M(),S("span",_t,"自定义主题")),p(f)==p(A)?(M(),S("span",$t," 已应用✔")):q("",!0),$(d("mdui-text-field",{label:"主题名称","onUpdate:modelValue":s[10]||(s[10]=l=>p(i).name=l)},null,512),[[W,p(i).name]]),d("mdui-select",{label:"深色/浅色模式",value:p(i).theme,onChange:s[11]||(s[11]=l=>p(i).theme=l.target.value)},s[25]||(s[25]=[d("mdui-menu-item",{value:"auto"},"跟随系统",-1),d("mdui-menu-item",{value:"light"},"浅色模式",-1),d("mdui-menu-item",{value:"dark"},"深色模式",-1),d("mdui-button-icon",{slot:"end-icon"},[d("mdui-icon-keyboard-arrow-down")],-1)]),40,Wt),d("mdui-text-field",{label:"背景图片URL",value:p(N),onInput:s[12]||(s[12]=l=>H(N)?N.value=l.target.value:N=l.target.value)},null,40,Ht),d("div",Kt,[s[26]||(s[26]=j(" 配色方案：")),$(d("input",{type:"color","onUpdate:modelValue":s[13]||(s[13]=l=>p(i).colorScheme=l)},null,512),[[W,p(i).colorScheme]]),d("mdui-button",{onClick:s[14]||(s[14]=l=>F()),disabled:!p(i).backgroundImage},"从背景图片中提取",8,Qt)]),p(U)?(M(),S("div",Xt,"提取失败。错误："+K(p(U)),1)):q("",!0),p(N)?(M(),S("div",Jt,[s[27]||(s[27]=j(" 背景图片不透明度： ")),d("mdui-slider",{tickmarks:"",max:"10",step:"1",value:p(i).backgroundImageOpacity*10,onInput:s[15]||(s[15]=l=>p(i).backgroundImageOpacity=l.target.value/10)},null,40,Zt),s[28]||(s[28]=j(" 侧边栏不透明度： ")),d("mdui-slider",{tickmarks:"",max:"10",step:"1",value:p(i).sidebarOpacity*10,onInput:s[16]||(s[16]=l=>p(i).sidebarOpacity=l.target.value/10)},null,40,Yt)])):q("",!0),d("mdui-button",{onClick:s[17]||(s[17]=l=>Ce()),disabled:!p(V)||p(i).isGeneral},"保存主题",8,es),d("mdui-button",{onClick:s[18]||(s[18]=l=>Ae())},"另存为新的主题"),d("mdui-button",{onClick:s[19]||(s[19]=l=>Ee()),disabled:p(f)==p(A)},"应用该主题",8,ts),d("mdui-button",{onClick:s[20]||(s[20]=l=>Re()),disabled:p(i).isGeneral},"删除主题",8,ss),p(P)?(M(),S("div",ns,"保存失败。"+K(p(P)),1)):q("",!0)])):q("",!0)])])]))}}),us=it(as,[["__scopeId","data-v-b69ecfd1"]]);export{us as default};
