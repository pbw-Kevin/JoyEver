import{T as Te,$ as D,U as Be,V as K,W as te,X as Se,Y as Me,Z as we,a0 as se,a1 as ke,a2 as ne,a3 as Ge,a4 as Le,a5 as Ne,a6 as Ve,a7 as ze,a8 as qe,a9 as _e,aa as je,ab as De,ac as Fe,ad as Pe,ae as Ue,af as $e,s as de,g as ce,h as me,j as he,k as fe,d as We,y as He,K as Ke,ag as ae,C as B,L as ie,ah as P,ai as re,p as Qe,aj as Xe,c as S,a as h,ak as Je,al as U,e as q,u as p,am as $,an as W,t as H,b as Z,F as Ze,q as Ye,ao as et,S as X,ap as tt,aq as st,o as M,ar as ve,as as nt,_ as at}from"./index-Cm6EkZQn.js";const it={onClick:K},pe="mdui.functions.dialog.";let Y;const Ce=v=>{const e=new Te,t=D(e),n=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions"],a=["onOpen","onOpened","onClose","onClosed","onOverlayClick"];return Object.entries(v).forEach(([r,u])=>{if(n.includes(r))e[r]=u;else if(a.includes(r)){const o=Be(r.slice(2));t.on(o,m=>{m.target===e&&u.call(e,e)})}}),v.body&&t.append(v.body),v.actions&&v.actions.forEach(r=>{const u=Object.assign({},it,r);D(`<mdui-button
        slot="action"
        variant="text"
      >${u.text}</mdui-button>`).appendTo(t).on("click",function(){const o=u.onClick.call(e,e);te(o)?(this.loading=!0,o.then(()=>{e.open=!1}).finally(()=>{this.loading=!1})):o!==!1&&(e.open=!1)})}),t.appendTo("body").on("closed",r=>{r.target===e&&(t.remove(),v.queue&&(Y=void 0,Se(pe+v.queue)))}),v.queue?Y?Me(pe+v.queue,()=>{e.open=!0,Y=e}):(setTimeout(()=>{e.open=!0}),Y=e):setTimeout(()=>{e.open=!0}),e},xe=()=>ne("OK"),be=()=>ne("Cancel"),rt=v=>{const e=Object.assign({},{confirmText:xe(),cancelText:be(),onConfirm:K,onCancel:K},v),t=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions","queue","onOpen","onOpened","onClose","onClosed","onOverlayClick"];return new Promise((n,a)=>{let r=!1;const u=Ce({...Object.fromEntries(t.filter(o=>!we(e[o])).map(o=>[o,e[o]])),actions:[{text:e.cancelText,onClick:o=>e.onCancel.call(o,o)},{text:e.confirmText,onClick:o=>{const m=e.onConfirm.call(o,o);return te(m)?m.then(()=>{r=!0}):m!==!1&&(r=!0),m}}]});v.confirmText||se(u,()=>{D(u).find('[slot="action"]').last().text(xe())}),v.cancelText||se(u,()=>{D(u).find('[slot="action"]').first().text(be())}),D(u).on("close",o=>{o.target===u&&(r?n():a(),ke(u))})})};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{fromInt(e){return Ge(e)}toInt(e){return Le(e[0],e[1],e[2])}distance(e,t){const n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return n*n+a*a+r*r}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lt=10,ut=3;class dt{static quantize(e,t,n){const a=new Map,r=new Array,u=new Array,o=new ot;let m=0;for(let c=0;c<e.length;c++){const y=e[c],T=a.get(y);T===void 0?(m++,r.push(o.fromInt(y)),u.push(y),a.set(y,1)):a.set(y,T+1)}const k=new Array;for(let c=0;c<m;c++){const y=u[c],T=a.get(y);T!==void 0&&(k[c]=T)}let f=Math.min(n,m);t.length>0&&(f=Math.min(f,t.length));const x=new Array;for(let c=0;c<t.length;c++)x.push(o.fromInt(t[c]));const I=f-x.length;if(t.length===0&&I>0)for(let c=0;c<I;c++){const y=Math.random()*100,T=Math.random()*201+-100,V=Math.random()*201+-100;x.push(new Array(y,T,V))}const b=new Array;for(let c=0;c<m;c++)b.push(Math.floor(Math.random()*f));const E=new Array;for(let c=0;c<f;c++){E.push(new Array);for(let y=0;y<f;y++)E[c].push(0)}const w=new Array;for(let c=0;c<f;c++){w.push(new Array);for(let y=0;y<f;y++)w[c].push(new ct)}const C=new Array;for(let c=0;c<f;c++)C.push(0);for(let c=0;c<lt;c++){for(let i=0;i<f;i++){for(let g=i+1;g<f;g++){const A=o.distance(x[i],x[g]);w[g][i].distance=A,w[g][i].index=i,w[i][g].distance=A,w[i][g].index=g}w[i].sort();for(let g=0;g<f;g++)E[i][g]=w[i][g].index}let y=0;for(let i=0;i<m;i++){const g=r[i],A=b[i],z=x[A],L=o.distance(g,z);let Q=L,_=-1;for(let F=0;F<f;F++){if(w[A][F].distance>=4*L)continue;const j=o.distance(g,x[F]);j<Q&&(Q=j,_=F)}_!==-1&&Math.abs(Math.sqrt(Q)-Math.sqrt(L))>ut&&(y++,b[i]=_)}if(y===0&&c!==0)break;const T=new Array(f).fill(0),V=new Array(f).fill(0),R=new Array(f).fill(0);for(let i=0;i<f;i++)C[i]=0;for(let i=0;i<m;i++){const g=b[i],A=r[i],z=k[i];C[g]+=z,T[g]+=A[0]*z,V[g]+=A[1]*z,R[g]+=A[2]*z}for(let i=0;i<f;i++){const g=C[i];if(g===0){x[i]=[0,0,0];continue}const A=T[i]/g,z=V[i]/g,L=R[i]/g;x[i]=[A,z,L]}}const O=new Map;for(let c=0;c<f;c++){const y=C[c];if(y===0)continue;const T=o.toInt(x[c]);O.has(T)||O.set(T,y)}return O}}class ct{constructor(){this.distance=-1,this.index=-1}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{static quantize(e){const t=new Map;for(let n=0;n<e.length;n++){const a=e[n];Ne(a)<255||t.set(a,(t.get(a)??0)+1)}return t}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=5,N=33,J=35937,G={RED:"red",GREEN:"green",BLUE:"blue"};class ht{constructor(e=[],t=[],n=[],a=[],r=[],u=[]){this.weights=e,this.momentsR=t,this.momentsG=n,this.momentsB=a,this.moments=r,this.cubes=u}quantize(e,t){this.constructHistogram(e),this.computeMoments();const n=this.createBoxes(t);return this.createResult(n.resultCount)}constructHistogram(e){this.weights=Array.from({length:J}).fill(0),this.momentsR=Array.from({length:J}).fill(0),this.momentsG=Array.from({length:J}).fill(0),this.momentsB=Array.from({length:J}).fill(0),this.moments=Array.from({length:J}).fill(0);const t=mt.quantize(e);for(const[n,a]of t.entries()){const r=Ve(n),u=ze(n),o=qe(n),m=8-ee,k=(r>>m)+1,f=(u>>m)+1,x=(o>>m)+1,I=this.getIndex(k,f,x);this.weights[I]=(this.weights[I]??0)+a,this.momentsR[I]+=a*r,this.momentsG[I]+=a*u,this.momentsB[I]+=a*o,this.moments[I]+=a*(r*r+u*u+o*o)}}computeMoments(){for(let e=1;e<N;e++){const t=Array.from({length:N}).fill(0),n=Array.from({length:N}).fill(0),a=Array.from({length:N}).fill(0),r=Array.from({length:N}).fill(0),u=Array.from({length:N}).fill(0);for(let o=1;o<N;o++){let m=0,k=0,f=0,x=0,I=0;for(let b=1;b<N;b++){const E=this.getIndex(e,o,b);m+=this.weights[E],k+=this.momentsR[E],f+=this.momentsG[E],x+=this.momentsB[E],I+=this.moments[E],t[b]+=m,n[b]+=k,a[b]+=f,r[b]+=x,u[b]+=I;const w=this.getIndex(e-1,o,b);this.weights[E]=this.weights[w]+t[b],this.momentsR[E]=this.momentsR[w]+n[b],this.momentsG[E]=this.momentsG[w]+a[b],this.momentsB[E]=this.momentsB[w]+r[b],this.moments[E]=this.moments[w]+u[b]}}}}createBoxes(e){this.cubes=Array.from({length:e}).fill(0).map(()=>new ft);const t=Array.from({length:e}).fill(0);this.cubes[0].r0=0,this.cubes[0].g0=0,this.cubes[0].b0=0,this.cubes[0].r1=N-1,this.cubes[0].g1=N-1,this.cubes[0].b1=N-1;let n=e,a=0;for(let r=1;r<e;r++){this.cut(this.cubes[a],this.cubes[r])?(t[a]=this.cubes[a].vol>1?this.variance(this.cubes[a]):0,t[r]=this.cubes[r].vol>1?this.variance(this.cubes[r]):0):(t[a]=0,r--),a=0;let u=t[0];for(let o=1;o<=r;o++)t[o]>u&&(u=t[o],a=o);if(u<=0){n=r+1;break}}return new gt(e,n)}createResult(e){const t=[];for(let n=0;n<e;++n){const a=this.cubes[n],r=this.volume(a,this.weights);if(r>0){const u=Math.round(this.volume(a,this.momentsR)/r),o=Math.round(this.volume(a,this.momentsG)/r),m=Math.round(this.volume(a,this.momentsB)/r),k=255<<24|(u&255)<<16|(o&255)<<8|m&255;t.push(k)}}return t}variance(e){const t=this.volume(e,this.momentsR),n=this.volume(e,this.momentsG),a=this.volume(e,this.momentsB),r=this.moments[this.getIndex(e.r1,e.g1,e.b1)]-this.moments[this.getIndex(e.r1,e.g1,e.b0)]-this.moments[this.getIndex(e.r1,e.g0,e.b1)]+this.moments[this.getIndex(e.r1,e.g0,e.b0)]-this.moments[this.getIndex(e.r0,e.g1,e.b1)]+this.moments[this.getIndex(e.r0,e.g1,e.b0)]+this.moments[this.getIndex(e.r0,e.g0,e.b1)]-this.moments[this.getIndex(e.r0,e.g0,e.b0)],u=t*t+n*n+a*a,o=this.volume(e,this.weights);return r-u/o}cut(e,t){const n=this.volume(e,this.momentsR),a=this.volume(e,this.momentsG),r=this.volume(e,this.momentsB),u=this.volume(e,this.weights),o=this.maximize(e,G.RED,e.r0+1,e.r1,n,a,r,u),m=this.maximize(e,G.GREEN,e.g0+1,e.g1,n,a,r,u),k=this.maximize(e,G.BLUE,e.b0+1,e.b1,n,a,r,u);let f;const x=o.maximum,I=m.maximum,b=k.maximum;if(x>=I&&x>=b){if(o.cutLocation<0)return!1;f=G.RED}else I>=x&&I>=b?f=G.GREEN:f=G.BLUE;switch(t.r1=e.r1,t.g1=e.g1,t.b1=e.b1,f){case G.RED:e.r1=o.cutLocation,t.r0=e.r1,t.g0=e.g0,t.b0=e.b0;break;case G.GREEN:e.g1=m.cutLocation,t.r0=e.r0,t.g0=e.g1,t.b0=e.b0;break;case G.BLUE:e.b1=k.cutLocation,t.r0=e.r0,t.g0=e.g0,t.b0=e.b1;break;default:throw new Error("unexpected direction "+f)}return e.vol=(e.r1-e.r0)*(e.g1-e.g0)*(e.b1-e.b0),t.vol=(t.r1-t.r0)*(t.g1-t.g0)*(t.b1-t.b0),!0}maximize(e,t,n,a,r,u,o,m){const k=this.bottom(e,t,this.momentsR),f=this.bottom(e,t,this.momentsG),x=this.bottom(e,t,this.momentsB),I=this.bottom(e,t,this.weights);let b=0,E=-1,w=0,C=0,O=0,c=0;for(let y=n;y<a;y++){if(w=k+this.top(e,t,y,this.momentsR),C=f+this.top(e,t,y,this.momentsG),O=x+this.top(e,t,y,this.momentsB),c=I+this.top(e,t,y,this.weights),c===0)continue;let T=(w*w+C*C+O*O)*1,V=c*1,R=T/V;w=r-w,C=u-C,O=o-O,c=m-c,c!==0&&(T=(w*w+C*C+O*O)*1,V=c*1,R+=T/V,R>b&&(b=R,E=y))}return new vt(E,b)}volume(e,t){return t[this.getIndex(e.r1,e.g1,e.b1)]-t[this.getIndex(e.r1,e.g1,e.b0)]-t[this.getIndex(e.r1,e.g0,e.b1)]+t[this.getIndex(e.r1,e.g0,e.b0)]-t[this.getIndex(e.r0,e.g1,e.b1)]+t[this.getIndex(e.r0,e.g1,e.b0)]+t[this.getIndex(e.r0,e.g0,e.b1)]-t[this.getIndex(e.r0,e.g0,e.b0)]}bottom(e,t,n){switch(t){case G.RED:return-n[this.getIndex(e.r0,e.g1,e.b1)]+n[this.getIndex(e.r0,e.g1,e.b0)]+n[this.getIndex(e.r0,e.g0,e.b1)]-n[this.getIndex(e.r0,e.g0,e.b0)];case G.GREEN:return-n[this.getIndex(e.r1,e.g0,e.b1)]+n[this.getIndex(e.r1,e.g0,e.b0)]+n[this.getIndex(e.r0,e.g0,e.b1)]-n[this.getIndex(e.r0,e.g0,e.b0)];case G.BLUE:return-n[this.getIndex(e.r1,e.g1,e.b0)]+n[this.getIndex(e.r1,e.g0,e.b0)]+n[this.getIndex(e.r0,e.g1,e.b0)]-n[this.getIndex(e.r0,e.g0,e.b0)];default:throw new Error("unexpected direction $direction")}}top(e,t,n,a){switch(t){case G.RED:return a[this.getIndex(n,e.g1,e.b1)]-a[this.getIndex(n,e.g1,e.b0)]-a[this.getIndex(n,e.g0,e.b1)]+a[this.getIndex(n,e.g0,e.b0)];case G.GREEN:return a[this.getIndex(e.r1,n,e.b1)]-a[this.getIndex(e.r1,n,e.b0)]-a[this.getIndex(e.r0,n,e.b1)]+a[this.getIndex(e.r0,n,e.b0)];case G.BLUE:return a[this.getIndex(e.r1,e.g1,n)]-a[this.getIndex(e.r1,e.g0,n)]-a[this.getIndex(e.r0,e.g1,n)]+a[this.getIndex(e.r0,e.g0,n)];default:throw new Error("unexpected direction $direction")}}getIndex(e,t,n){return(e<<ee*2)+(e<<ee+1)+e+(t<<ee)+t+n}}class ft{constructor(e=0,t=0,n=0,a=0,r=0,u=0,o=0){this.r0=e,this.r1=t,this.g0=n,this.g1=a,this.b0=r,this.b1=u,this.vol=o}}class gt{constructor(e,t){this.requestedCount=e,this.resultCount=t}}class vt{constructor(e,t){this.cutLocation=e,this.maximum=t}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{static quantize(e,t){const a=new ht().quantize(e,t);return dt.quantize(e,a,t)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xt(v){const e=await new Promise((u,o)=>{const m=document.createElement("canvas"),k=m.getContext("2d");if(!k){o(new Error("Could not get canvas context"));return}const f=()=>{m.width=v.width,m.height=v.height,k.drawImage(v,0,0);let I=[0,0,v.width,v.height];const b=v.dataset.area;b&&/^\d+(\s*,\s*\d+){3}$/.test(b)&&(I=b.split(/\s*,\s*/).map(c=>parseInt(c,10)));const[E,w,C,O]=I;u(k.getImageData(E,w,C,O).data)},x=()=>{o(new Error("Image load failed"))};v.complete?f():(v.onload=f,v.onerror=x)}),t=[];for(let u=0;u<e.length;u+=4){const o=e[u],m=e[u+1],k=e[u+2];if(e[u+3]<255)continue;const x=je(o,m,k);t.push(x)}const n=pt.quantize(t,128);return _e.score(n)[0]}const bt=async v=>{const e=D(v),t=await xt(e[0]);return De(t)},ye=()=>ne("OK"),Ie=()=>ne("Cancel"),yt=v=>{const e=Object.assign({},{confirmText:ye(),cancelText:Ie(),onConfirm:K,onCancel:K,validator:K,textFieldOptions:{}},v),t=["headline","description","icon","closeOnEsc","closeOnOverlayClick","stackedActions","queue","onOpen","onOpened","onClose","onClosed","onOverlayClick"],n=new Fe;return Object.entries(e.textFieldOptions).forEach(([a,r])=>{n[a]=r}),new Promise((a,r)=>{let u=!1;const o=Ce({...Object.fromEntries(t.filter(m=>!we(e[m])).map(m=>[m,e[m]])),body:n,actions:[{text:e.cancelText,onClick:m=>e.onCancel.call(m,n.value,m)},{text:e.confirmText,onClick:m=>{const k=()=>{const x=e.onConfirm.call(m,n.value,m);return te(x)?x.then(()=>{u=!0}):x!==!1&&(u=!0),x};if(n.setCustomValidity(""),!n.reportValidity())return!1;const f=e.validator.call(n,n.value);return Pe(f)&&!f?(n.setCustomValidity(" "),!1):Ue(f)?(n.setCustomValidity(f),!1):te(f)?new Promise((x,I)=>{f.then(x).catch(b=>{n.setCustomValidity(b),I(b)})}):k()}}]});v.confirmText||se(o,()=>{D(o).find('[slot="action"]').last().text(ye())}),v.cancelText||se(o,()=>{D(o).find('[slot="action"]').first().text(Ie())}),D(o).on("close",m=>{m.target===o&&(u?a(n.value):r(),ke(o))})})},It=(v,e=0)=>{const t=$e();let n,a;return function(...r){return n===void 0&&(n=t.setTimeout(()=>{a=v.apply(this,r),n=void 0},e)),a}};let oe=class extends he{render(){return fe('<path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>')}};oe.styles=de;oe=ce([me("mdui-icon-settings")],oe);let le=class extends he{render(){return fe('<path d="M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>')}};le.styles=de;le=ce([me("mdui-icon-security")],le);let ue=class extends he{render(){return fe('<path d="M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10a2.5 2.5 0 0 0 2.5-2.5c0-.61-.23-1.2-.64-1.67a.528.528 0 0 1-.13-.33c0-.28.22-.5.5-.5H16c3.31 0 6-2.69 6-6 0-4.96-4.49-9-10-9zm5.5 11c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm-3-4c-.83 0-1.5-.67-1.5-1.5S13.67 6 14.5 6s1.5.67 1.5 1.5S15.33 9 14.5 9zM5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S7.33 13 6.5 13 5 12.33 5 11.5zm6-4c0 .83-.67 1.5-1.5 1.5S8 8.33 8 7.5 8.67 6 9.5 6s1.5.67 1.5 1.5z"/>')}};ue.styles=de;ue=ce([me("mdui-icon-palette")],ue);const wt={class:"content"},kt={value:"global","full-width":"",variant:"secondary"},Ct={slot:"panel",value:"global"},At=["value"],Et={slot:"helper",class:"error-info"},Rt={key:0},Ot=["checked"],Tt={key:0},Bt={key:1},St=["disabled"],Mt={key:3},Gt={key:4},Lt={slot:"panel",value:"security"},Nt={slot:"helper",class:"error-info"},Vt={slot:"helper",class:"error-info"},zt={key:0},qt={slot:"panel",value:"appearance"},_t=["value"],jt=["value"],Dt={key:0,class:"appearance-card"},Ft={key:0},Pt={key:1},Ut={key:2},$t=["value"],Wt=["value"],Ht={class:"color-scheme"},Kt=["disabled"],Qt={key:3,class:"error-info"},Xt={key:4},Jt=["value"],Zt=["value"],Yt=["disabled"],es=["disabled"],ts=["disabled"],ss={key:5,class:"error-info"},ns=We({__name:"SettingView",setup(v){He();var e=Ke(),t=e.getUsername(),n=new ae.Object("UserInfo"),a=B(""),r=B(e.get("email")),u=B(!!r.value),o=new ae.Object("Email"),m=B(!1),k=B(e.get("emailVerified")),f=B(!1),x=B(!1);ie.get("userInfo").then(d=>{d&&(n=d,a.value=n.get("nickname"))}),ie.get("email").then(d=>{d&&(o=d,m.value=d.getACL().getPublicReadAccess())}),P(a,d=>{n.set("nickname",d)});var I=B("");function b(){if(I.value="",r.value&&!et(r.value)){I.value="邮箱格式不正确。";return}e.setEmail(r.value),e.save().then(d=>(k.value=d.get("emailVerified"),u.value=!!r.value,o.set("email",r.value))).then(()=>{X("邮箱已保存！",!0)}).catch(d=>{if(d.code==203){I.value="邮箱已被使用。请尝试其他邮箱。";return}I.value="保存邮箱时出现问题。"}),f.value=!1,x.value=!1}P(r,()=>{I.value=""});function E(d){m.value=d,o.getACL().setPublicReadAccess(d),o.save().then(()=>{X("邮箱隐私设置已更新！",!0)}).catch(s=>{X("更新邮箱隐私设置时出现问题。",!0)})}function w(){ae.User.requestEmailVerify(r.value).then(()=>{f.value=!0}).catch(d=>{x.value=!0})}var C=B(""),O=B(""),c=B({password:"",passwordAgain:""}),y=B(!1);function T(){if(c.value={password:"",passwordAgain:""},y.value=!1,C.value)if(tt(C.value))if(C.value!==O.value){c.value.passwordAgain="两次输入的密码不一致。";return}else e.setPassword(C.value),y.value=!0;else{c.value.password="密码格式不正确。密码的长度应至少为 8 个字符，且不为空白字符。";return}else{c.value.password="请填写密码。";return}}var V=re(),R=B(ve),i=B({...re().value}),g=B(i.value.name),A=B(i.value.name),z=Qe(()=>JSON.stringify(R.value.find(d=>d.name===g.value))!==JSON.stringify(i.value));P(nt,d=>{d&&(R.value=ve,i.value={...re().value},g.value=i.value.name,A.value=i.value.name)});var L=B(i.value.backgroundImage);P(g,d=>{var s=R.value.find(l=>l.name===d);s&&(i.value={...s},L.value=s.backgroundImage)}),P(i,d=>{V.value={...d}},{deep:!0});var Q=It(d=>{i.value.backgroundImage=d},1e3);P(L,(d,s)=>{d?s?Q(d):(i.value.backgroundImageOpacity=.3,i.value.sidebarOpacity=.7,i.value.backgroundImage=d):(i.value.backgroundImageOpacity=0,i.value.sidebarOpacity=1)});var _=B("");function F(){_.value="";var d=new Image;d.src=i.value.backgroundImage,d.crossOrigin="anonymous",d.onload=()=>{bt(d).then(s=>{i.value.colorScheme=s}).catch(s=>{_.value=s.message})},d.onerror=s=>{_.value="无法加载背景图片。可能是跨域问题或图片不存在。"}}var j=B("");function Ae(){j.value="";var d=R.value.find(l=>l.name===g.value);if(d){var s=R.value.find(l=>l.name===i.value.name);if(s&&s!==d){j.value="主题名已存在";return}Object.assign(d,{...i.value})}else R.value.push({...i.value});A.value===g.value&&(A.value=i.value.name),g.value=i.value.name}function Ee(){yt({headline:"另存为新的主题",description:"在此处键入主题名",confirmText:"完成",cancelText:"取消",onConfirm:d=>{if(!d){j.value="主题名不能为空";return}if(R.value.some(l=>l.name===d)){j.value="主题名已存在。";return}var s={...i.value,name:d,isGeneral:!1};R.value.push(s),g.value=d}})}function Re(){A.value=g.value,st(i.value)}function Oe(){rt({headline:"确认要删除主题吗？",description:"此操作不可撤销",confirmText:"删除",cancelText:"取消",onConfirm:()=>{var d;R.value=R.value.filter(s=>s.name!==g.value),g.value==A.value&&(A.value=((d=R.value.find(s=>s.isGeneral))==null?void 0:d.name)||""),g.value=A.value}})}async function ge(){var d=!1;await e.save().catch(s=>{d=!0}),await n.save().catch(s=>{d=!0}),await o.save().catch(s=>{d=!0}),await ie.get("privateUserInfo").then(async s=>{if(!s){d=!0;return}s.set("customAppearance",R.value.filter(l=>!l.isGeneral).map(l=>({name:l.name,theme:l.theme,backgroundImage:l.backgroundImage,colorScheme:l.colorScheme,backgroundImageOpacity:l.backgroundImageOpacity,sidebarOpacity:l.sidebarOpacity}))),s.set("activeAppearance",A.value),await s.save().catch(l=>{d=!0})}),d?X("保存时出现问题。",!0):X("保存成功！",!0)}return Xe(()=>{ge()}),(d,s)=>(M(),S("div",wt,[s[35]||(s[35]=h("h1",null,"设置",-1)),h("mdui-button",{onClick:s[0]||(s[0]=l=>ge())},"保存设置"),h("mdui-tabs",kt,[s[33]||(s[33]=Je('<mdui-tab value="global" data-v-0019bff7> 全局设置 <mdui-icon-settings slot="icon" data-v-0019bff7></mdui-icon-settings></mdui-tab><mdui-tab value="security" data-v-0019bff7> 安全 <mdui-icon-security slot="icon" data-v-0019bff7></mdui-icon-security></mdui-tab><mdui-tab value="game" data-v-0019bff7> 游戏设置 <mdui-icon-videogame-asset slot="icon" data-v-0019bff7></mdui-icon-videogame-asset></mdui-tab><mdui-tab value="appearance" data-v-0019bff7> 外观 <mdui-icon-palette slot="icon" data-v-0019bff7></mdui-icon-palette></mdui-tab>',4)),h("mdui-tab-panel",Ct,[s[22]||(s[22]=h("h2",null,"全局设置",-1)),h("mdui-text-field",{label:"用户名",variant:"outlined",readonly:"",value:p(t)},null,8,At),U(h("mdui-text-field",{label:"昵称","onUpdate:modelValue":s[1]||(s[1]=l=>W(a)?a.value=l:a=l)},null,512),[[$,p(a)]]),s[23]||(s[23]=h("h3",null,"邮箱",-1)),U(h("mdui-text-field",{type:"email",label:"邮箱","onUpdate:modelValue":s[2]||(s[2]=l=>W(r)?r.value=l:r=l)},[h("span",Et,H(p(I)),1)],512),[[$,p(r)]]),h("mdui-button",{onClick:s[3]||(s[3]=l=>b())},"保存邮箱"),p(u)?(M(),S("div",Rt,[h("mdui-checkbox",{checked:p(m),onInput:s[4]||(s[4]=l=>E(!l.target.checked))},"公开邮箱",40,Ot),s[21]||(s[21]=Z(" 邮箱状态：")),p(k)?(M(),S("span",Tt,"已验证✔")):(M(),S("span",Bt,"未验证❌")),p(k)?q("",!0):(M(),S("mdui-button",{key:2,onClick:s[5]||(s[5]=l=>w()),disabled:p(f)},"邮箱验证",8,St)),p(f)?(M(),S("span",Mt,"验证邮件已发送")):q("",!0),p(x)?(M(),S("span",Gt,"发送验证邮件失败")):q("",!0)])):q("",!0)]),h("mdui-tab-panel",Lt,[s[24]||(s[24]=h("h2",null,"安全",-1)),s[25]||(s[25]=h("h3",null,"修改密码",-1)),U(h("mdui-text-field",{type:"password","toggle-password":"",label:"新密码","onUpdate:modelValue":s[6]||(s[6]=l=>W(C)?C.value=l:C=l)},[h("span",Nt,H(p(c).password),1)],512),[[$,p(C)]]),U(h("mdui-text-field",{type:"password","toggle-password":"",label:"确认新密码","onUpdate:modelValue":s[7]||(s[7]=l=>W(O)?O.value=l:O=l)},[h("span",Vt,H(p(c).passwordAgain),1)],512),[[$,p(O)]]),h("mdui-button",{onClick:s[8]||(s[8]=l=>T())},"更改密码"),p(y)?(M(),S("span",zt,"密码已更改！")):q("",!0)]),s[34]||(s[34]=h("mdui-tab-panel",{slot:"panel",value:"game"},[h("h2",null,"游戏设置"),h("mdui-checkbox",null,"公开历史记录"),h("br"),h("mdui-checkbox",null,"自动禁用不可用手势"),h("h3",null,"自定义手势"),h("p",null,"自定义手势会被自动判定为爆盾。")],-1)),h("mdui-tab-panel",qt,[s[31]||(s[31]=h("h2",null,"外观",-1)),s[32]||(s[32]=h("h3",null,"主题",-1)),h("mdui-select",{label:"选择主题",value:p(g),onChange:s[9]||(s[9]=l=>W(g)?g.value=l.target.value:g=l.target.value)},[(M(!0),S(Ze,null,Ye(p(R),l=>(M(),S("mdui-menu-item",{value:l.name},H(l.name),9,jt))),256)),s[26]||(s[26]=h("mdui-button-icon",{slot:"end-icon"},[h("mdui-icon-keyboard-arrow-down")],-1))],40,_t),p(g)?(M(),S("mdui-card",Dt,[p(i).isGeneral?(M(),S("span",Ft,"系统主题")):(M(),S("span",Pt,"自定义主题")),p(g)==p(A)?(M(),S("span",Ut," 已应用✔")):q("",!0),U(h("mdui-text-field",{label:"主题名称","onUpdate:modelValue":s[10]||(s[10]=l=>p(i).name=l)},null,512),[[$,p(i).name]]),h("mdui-select",{label:"深色/浅色模式",value:p(i).theme,onChange:s[11]||(s[11]=l=>p(i).theme=l.target.value)},s[27]||(s[27]=[h("mdui-menu-item",{value:"auto"},"跟随系统",-1),h("mdui-menu-item",{value:"light"},"浅色模式",-1),h("mdui-menu-item",{value:"dark"},"深色模式",-1),h("mdui-button-icon",{slot:"end-icon"},[h("mdui-icon-keyboard-arrow-down")],-1)]),40,$t),h("mdui-text-field",{label:"背景图片URL",value:p(L),onInput:s[12]||(s[12]=l=>W(L)?L.value=l.target.value:L=l.target.value)},null,40,Wt),h("div",Ht,[s[28]||(s[28]=Z(" 配色方案：")),U(h("input",{type:"color","onUpdate:modelValue":s[13]||(s[13]=l=>p(i).colorScheme=l)},null,512),[[$,p(i).colorScheme]]),h("mdui-button",{onClick:s[14]||(s[14]=l=>F()),disabled:!p(i).backgroundImage},"从背景图片中提取",8,Kt)]),p(_)?(M(),S("div",Qt,"提取失败。错误："+H(p(_)),1)):q("",!0),p(L)?(M(),S("div",Xt,[s[29]||(s[29]=Z(" 背景图片不透明度： ")),h("mdui-slider",{tickmarks:"",max:"10",step:"1",value:p(i).backgroundImageOpacity*10,onInput:s[15]||(s[15]=l=>p(i).backgroundImageOpacity=l.target.value/10)},null,40,Jt),s[30]||(s[30]=Z(" 侧边栏不透明度： ")),h("mdui-slider",{tickmarks:"",max:"10",step:"1",value:p(i).sidebarOpacity*10,onInput:s[16]||(s[16]=l=>p(i).sidebarOpacity=l.target.value/10)},null,40,Zt)])):q("",!0),h("mdui-button",{onClick:s[17]||(s[17]=l=>Ae()),disabled:!p(z)||p(i).isGeneral},"保存主题",8,Yt),h("mdui-button",{onClick:s[18]||(s[18]=l=>Ee())},"另存为新的主题"),h("mdui-button",{onClick:s[19]||(s[19]=l=>Re()),disabled:p(g)==p(A)},"应用该主题",8,es),h("mdui-button",{onClick:s[20]||(s[20]=l=>Oe()),disabled:p(i).isGeneral},"删除主题",8,ts),p(j)?(M(),S("div",ss,"保存失败。"+H(p(j)),1)):q("",!0)])):q("",!0)])])]))}}),ls=at(ns,[["__scopeId","data-v-0019bff7"]]);export{ls as default};
